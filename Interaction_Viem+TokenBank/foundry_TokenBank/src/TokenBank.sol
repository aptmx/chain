// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

/*
    编写一个 TokenBank 合约，可以将自己的 Token 存入到 TokenBank， 和从 TokenBank 取出。

    TokenBank 有两个方法：

    deposit() : 需要记录每个地址的存入数量；
    withdraw（）: 用户可以提取自己的之前存入的 token。

*/


import "./Token.sol";


//user token.approve(TokenBank.address, amount);

contract TokenBank{
    mapping(address => uint256) public balances;
    BaseERC20 public token;

    constructor (BaseERC20 _token) {
        token = _token;
    }

    function deposit (uint256 amount) public {
        
        require(token.transferFrom(msg.sender, address(this), amount), "transferFrom failed");

        //记账
        balances[msg.sender] += amount;

    }


    function withdraw(uint256 amount) public {
        
        require(balances[msg.sender] >= amount, "user's balance not enough");
        require(token.transfer(msg.sender, amount),"transfer failed");
       
        //记账
        balances[msg.sender] -= amount;

    }
}


//608060405234801561000f575f80fd5b506040516109ca3803806109ca833981810160405281019061003191906100e6565b8060025f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050610111565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100a48261007b565b9050919050565b5f6100b58261009a565b9050919050565b6100c5816100ab565b81146100cf575f80fd5b50565b5f815190506100e0816100bc565b92915050565b5f602082840312156100fb576100fa610077565b5b5f610108848285016100d2565b91505092915050565b6108ac8061011e5f395ff3fe608060405234801561000f575f80fd5b5060043610610055575f3560e01c80631a39d8ef1461005957806327e235e3146100775780632e1a7d4d146100a7578063b6b55f25146100c3578063fc0c546a146100df575b5f80fd5b6100616100fd565b60405161006e9190610465565b60405180910390f35b610091600480360381019061008c91906104dc565b610103565b60405161009e9190610465565b60405180910390f35b6100c160048036038101906100bc9190610531565b610117565b005b6100dd60048036038101906100d89190610531565b6102de565b005b6100e7610428565b6040516100f491906105b7565b60405180910390f35b60015481565b5f602052805f5260405f205f915090505481565b805f803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20541015610196576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161018d9061062a565b60405180910390fd5b60025f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33836040518363ffffffff1660e01b81526004016101f2929190610657565b6020604051808303815f875af115801561020e573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061023291906106b3565b610271576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161026890610728565b60405180910390fd5b805f803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8282546102bc9190610773565b925050819055508060015f8282546102d49190610773565b9250508190555050565b60025f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166323b872dd3330846040518463ffffffff1660e01b815260040161033c939291906107a6565b6020604051808303815f875af1158015610358573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061037c91906106b3565b6103bb576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103b290610825565b60405180910390fd5b805f803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8282546104069190610843565b925050819055508060015f82825461041e9190610843565b9250508190555050565b60025f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f819050919050565b61045f8161044d565b82525050565b5f6020820190506104785f830184610456565b92915050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6104ab82610482565b9050919050565b6104bb816104a1565b81146104c5575f80fd5b50565b5f813590506104d6816104b2565b92915050565b5f602082840312156104f1576104f061047e565b5b5f6104fe848285016104c8565b91505092915050565b6105108161044d565b811461051a575f80fd5b50565b5f8135905061052b81610507565b92915050565b5f602082840312156105465761054561047e565b5b5f6105538482850161051d565b91505092915050565b5f819050919050565b5f61057f61057a61057584610482565b61055c565b610482565b9050919050565b5f61059082610565565b9050919050565b5f6105a182610586565b9050919050565b6105b181610597565b82525050565b5f6020820190506105ca5f8301846105a8565b92915050565b5f82825260208201905092915050565b7f7573657227732062616c616e6365206e6f7420656e6f756768000000000000005f82015250565b5f6106146019836105d0565b915061061f826105e0565b602082019050919050565b5f6020820190508181035f83015261064181610608565b9050919050565b610651816104a1565b82525050565b5f60408201905061066a5f830185610648565b6106776020830184610456565b9392505050565b5f8115159050919050565b6106928161067e565b811461069c575f80fd5b50565b5f815190506106ad81610689565b92915050565b5f602082840312156106c8576106c761047e565b5b5f6106d58482850161069f565b91505092915050565b7f7472616e73666572206661696c656400000000000000000000000000000000005f82015250565b5f610712600f836105d0565b915061071d826106de565b602082019050919050565b5f6020820190508181035f83015261073f81610706565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f61077d8261044d565b91506107888361044d565b92508282039050818111156107a05761079f610746565b5b92915050565b5f6060820190506107b95f830186610648565b6107c66020830185610648565b6107d36040830184610456565b949350505050565b7f7472616e7366657246726f6d206661696c6564000000000000000000000000005f82015250565b5f61080f6013836105d0565b915061081a826107db565b602082019050919050565b5f6020820190508181035f83015261083c81610803565b9050919050565b5f61084d8261044d565b91506108588361044d565b92508282019050808211156108705761086f610746565b5b9291505056fea26469706673582212209c76163e8290f14bca4b3a9d569e1fef2268f4973e7604956d945b66bd62f22064736f6c634300081a0033

